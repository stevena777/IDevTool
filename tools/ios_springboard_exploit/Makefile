# iOS SpringBoard Exploit Toolkit Makefile
# Targets iOS 26.2 SpringBoard UI glitch exploitation

CC = g++
CFLAGS = -std=c++11 -Wall -O2
LIBS = -limobiledevice-1.0 -lplist-2.0

# Include paths
INCLUDES = -I/ucrt64/include -I/ucrt64/include/libimobiledevice

# Library paths
LDFLAGS = -L/ucrt64/lib

# Targets
TARGETS = usb_monitor.exe service_probe.exe

.PHONY: all clean test

all: $(TARGETS)
	@echo ""
	@echo "╔══════════════════════════════════════════════════════╗"
	@echo "║  iOS SpringBoard Exploit Toolkit - Build Complete   ║"
	@echo "╚══════════════════════════════════════════════════════╝"
	@echo ""
	@echo "Built executables:"
	@echo "  - usb_monitor.exe    : Fast USB device monitoring"
	@echo "  - service_probe.exe  : iOS service accessibility checker"
	@echo ""
	@echo "Quick Start:"
	@echo "  1. Run: ./usb_monitor.exe"
	@echo "  2. Trigger SpringBoard glitch on iPhone"
	@echo "  3. When device detected, run: ./service_probe.exe"
	@echo "  4. If AFC accessible, run: python springboard_exploit.py"
	@echo ""

usb_monitor.exe: usb_monitor.cpp
	@echo "[BUILD] Compiling USB monitor..."
	$(CC) $(CFLAGS) $(INCLUDES) -o $@ $< $(LDFLAGS) $(LIBS)

service_probe.exe: service_probe.cpp
	@echo "[BUILD] Compiling service probe..."
	$(CC) $(CFLAGS) $(INCLUDES) -o $@ $< $(LDFLAGS) $(LIBS)

clean:
	@echo "[CLEAN] Removing build artifacts..."
	rm -f $(TARGETS)
	rm -f *.o
	rm -f exploit_log_*.txt
	@echo "[CLEAN] Done"

test: all
	@echo ""
	@echo "╔══════════════════════════════════════════════════════╗"
	@echo "║  Running Tests                                       ║"
	@echo "╚══════════════════════════════════════════════════════╝"
	@echo ""
	@echo "[TEST] Checking if device is connected..."
	@./usb_monitor.exe &
	@sleep 2
	@pkill -f usb_monitor.exe || true
	@echo ""
	@echo "[TEST] If device detected above, exploitation possible"
	@echo "[TEST] If not, connect iPhone and trigger glitch"

install: all
	@echo "[INSTALL] Installing to /usr/local/bin..."
	@mkdir -p /usr/local/bin
	@cp $(TARGETS) /usr/local/bin/
	@echo "[INSTALL] Done"

help:
	@echo ""
	@echo "iOS SpringBoard Exploit Toolkit - Makefile Commands"
	@echo "======================================================"
	@echo ""
	@echo "  make          - Build all tools"
	@echo "  make clean    - Remove build artifacts"
	@echo "  make test     - Test device detection"
	@echo "  make install  - Install to /usr/local/bin"
	@echo "  make help     - Show this help"
	@echo ""
	@echo "Usage Workflow:"
	@echo "  1. make                    # Build everything"
	@echo "  2. ./usb_monitor.exe       # Start monitoring"
	@echo "  3. [Trigger glitch]        # On iPhone"
	@echo "  4. ./service_probe.exe     # Check services"
	@echo "  5. python springboard_exploit.py  # Full exploitation"
	@echo ""
